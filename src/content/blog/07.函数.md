---
title: 07.[SQL]函数
description: /
pubDate: 08 10 2025
categories:
  - tech
tags:
  - SQL
---
## 内置函数

MySQL 提供了丰富的内置函数，可以用来处理数据。

常用于语句：
```sql
update table_name set column_name = function(column_name)
where condition;
```

### 字符串函数

| 函数 | 描述 |
| --- | --- |
| `CONCAT(S1, S2,...)` | 用于连接两个或多个字符串。 |
| `LOWER(S)` | 用于将字符串转换为小写。 |
| `UPPER(S)` | 用于将字符串转换为大写。 |
| `LPAD(S, LENGTH, PAD)` | 用于在字符串左侧填充指定字符pad，使得字符串的长度达到指定长度length。 |
| `RPAD(S, LENGTH, PAD)` | 用于在字符串右侧填充指定字符pad，使得字符串的长度达到指定长度length。 |
| `TRIM(S)` | 用于删除字符串s两端的空白字符。 |
| `SUBSTRING(S, POS, LENGTH)` | 用于从字符串s中提取子串,从位置pos开始,长度为length。pos是一个从1开始的索引值。 |

### 数值函数

| 函数 | 描述 |
| --- | --- |
| CEIL(X) | 向上取整的取整函数 |
| FLOOR(X) | 向下取整的取整函数 |
| ROUND(X, D) | 用于返回X四舍五入到小数点后D位的结果。 |
| RAND() | 用于返回一个0到1之间的随机数。 |
| MOD(X, Y) | 用于返回X取模Y的结果 |

生成一个6位的随机数：
```sql
SELECT lpad(round( RAND()*1e6 , 0), 6, '0');

#rand给出一个随机小数，乘以1e6后，再四舍五入到整数，得到一个6位的随机数。
#避免首位0缩减，使用lpad函数在左侧填充0。

```
### 日期函数
(CUR=current)

| 函数 | 描述 |
| --- | --- |
| CURDATE() | 用于返回当前日期。 |
| CURTIME() | 用于返回当前时间。 |
| NOW() | 用于返回当前日期和时间。 |
| YEAR(D) | 用于返回日期D的年份。 |
| MONTH(D) | 用于返回日期D的月份。 |
| DAY(D) | 用于返回日期D的天数。 |
|DATE_ADD(D, INTERVAL N type) | 用于返回日期D加上Ntype类型的间隔后的日期。 |
|DATEDIFF(type, D1, D2) | 用于返回两个日期D1和D2之间的时间间隔。 |

1.date_add函数的interval是固定词
2.date_diff函数是前减后，所以D1是减数，D2是被减数，可能产生负数。

### 流程控制函数

| 函数 | 描述 |
| --- | --- |
| IF(expr, val1, val2) | 条件判断，如果expr为真，则返回val1，否则返回val2。 |
| IFNULL(expr, val) | 如果expr为NULL，则返回val，否则返回expr。 |

条件判断：
```sql
CASE WHEN [value1] THEN [result1] 
     WHEN [value2] THEN [result2]... 
     ELSE [default] END
# 条件判断 若value1为真，则返回result1，否则继续判断value2，直到找到真值，返回对应的result。若没有真值，则返回default。
```
条件选择：
```sql
CASE [expr] 
     WHEN [value1] THEN [result1] 
     WHEN [value2] THEN [result2]... 
     ELSE [default] END
# 条件选择 若expr的值等于value1，则返回result1，否则继续判断expr的值是否等于value2，直到找到匹配值，返回对应的result。若没有匹配值，则返回default。
```
通过case语句，可以根据性别字段的值，返回对应的性别名称。最后用as给列名改名（临时列名）。
```sql
select name,
       (case gender when 1 then '男' when 0 then '女' else '不存在' end )as '性别'
from emp;
```