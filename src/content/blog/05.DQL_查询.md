---
title: 05.[SQL]DQL 查询
description: /
pubDate: 08 08 2025
categories:
  - tech
tags:
  - SQL
---

## DQL 查询

### 运行顺序

```sql
select           # 4

from             # 1

where            # 2

group by         # 3

order by         # 5

limit            # 6
```

### select 语句

返回一个表的子集，包含指定列的数据:

```sql
SELECT column1, column2, column3,...  # 起别名：[column1 AS new_name1]
FROM table_name;
```

返回结果去重：（distinct）

```sql
SELECT DISTINCT column1, column2, column3,...
FROM table_name;
```

### where 子句

过滤数据：

```sql
SELECT column1, column2, column3,...
FROM table_name
WHERE condition;
```

| 比较运算符 | 说明 |
| --- | --- |
| = | 等于 |
| <> 或 != | 不等于 |
| > | 大于 |
| < | 小于 |
| >= | 大于等于 |
| <= | 小于等于 |
| BETWEEN... AND... | 在某个范围内 |
| LIKE 'pattern' | 模糊匹配，'%'表示任意字符，'_'表示一个字符 |
| IN (value1, value2,...) | 匹配指定的值 |
| IS NULL | 为空 |

| 逻辑运算符 | 说明 |
| --- | --- |
| AND 或 && | 与 |
| OR 或 \|\| | 或 |
| NOT 或 ! | 非 |

1.IN() 语句是用来带替多个or的，比如：` WHERE id IN (1,2,3) ` 和 ` WHERE id = 1 OR id = 2 OR id = 3 ` 是等价的。

2.like语句常用的方式如：` WHERE name LIKE '张%' ` 匹配到所有姓名以张开头的,如张三，张无忌。`WHERE name LIKE '__' ` 匹配到所有姓名中有两个字符的。

### 聚合函数

用于计算表中值的总和、平均值、最大值、最小值等。

```sql
SELECT aggregate_function(column_name)
FROM table_name;
```

| 聚合函数 | 说明 |
| --- | --- |
| COUNT() | 返回指定列的非空行数 |
| SUM() | 返回指定列的总和 |
| AVG() | 返回指定列的平均值 |
| MAX() | 返回指定列的最大值 |
| MIN() | 返回指定列的最小值 |  

 null 不参与计算，所以统计总数时使用 `COUNT(*)`。


 ### 分组 group by

将数据分组，然后对分组进行聚合操作。

```sql
SELECT column1, column2, aggregate_function(column3)
FROM table_name [WHERE condition]
GROUP BY column1, column2 [having condition]; # 过滤分组后的结果
```

区分where和having的区别：

- where：在分组前过滤数据，在分组后不再使用。
- having：在分组后过滤分组后的结果，在分组前不使用。group by 会把表分组为若干个只含有`column1, column2, aggregate_function(column3)`的子表。然后，having 子句会对这些子表进行过滤，只保留满足条件的子表。

### 排序 order by
对查询结果进行排序。

```sql
SELECT column1, column2, column3,...
FROM table_name
ORDER BY column1, column2 [DESC|ASC];
```

1.DESC：降序，默认升序，可省略。
2.ASC：升序。

### 分页查询 limit

限制返回结果的数量。limit是mysql的方言。

```sql
SELECT column1, column2, column3,...
FROM table_name
LIMIT [offset,] count;
```
1.offset：索引起始位置（偏移量，0就是不偏移，单位是条数，偏移4就是从第五条数据开始），默认为0，索引页码：offset/count+1，如第一页，offset=0，count=10，则返回索引为1-10的数据，第二页，offset=10，count=10，则返回索引为11-20的数据。

2.count：返回的结果数量，默认为10，最大值为1000，也就是每一页显示的记录数。



